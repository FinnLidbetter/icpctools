== The ICPC Balloon Utility 

image::balloonIcon.png["Balloon Utility",scaledwidth="5%"]

An ICPC Tool

The ICPC Balloon Utility (BU) is a tool for keeping track of balloons earned by contest teams
for successful run submissions.  It receives submission information from one of several
input sources, displays information about each submission (such as the problem, team,
run ID, school, submission time, etc.) and optionally automatically prints "balloon
notification" messages to assist runners in delivering balloons.  It also provides 
runners with an interactive mechanism for tracking delivered balloons, and is even
capable of printing maps showing runners where to go find the appropriate balloon
and where on the contest floor the receiving team is located (although instructions
for configuring it to do that are beyond the scope of this introductory guide).

The following shows a screen shot of the Balloon Utility main screen, after it has been 
loaded with run submission information from a Contest Control System:

image::BUScreenshot.png["Balloon Utility screen capture",align="center"]

=== Using the Balloon Utility

==== Installation

To install the Balloon Utility, download its distribution package from https://icpc.baylor.edu/icpctools/
and unzip it to any convenient location. 
The BU is a Java program. The distribution is a self-contained package which contains 
all the Java libraries and other components necessary to run the Balloon Utility.
(Note that Java, Version 1.8 or higher, must also be installed on the machine.)

==== Execution

The BU distribution includes a set of scripts which can be used to launch the program.  
Each of these scripts has a name like _balloon.ext_, where "ext" is "bat" for
MS-Windows platforms or ".sh" for Unix-like platforms
(including Linux and MacOSX).  To start the BU, open a terminal window (command shell), 
change to the folder where you unzipped the distribution, and type the name of the
appropriate script.  The scripts do not require any parameters, although adding
"--help" will generate a mildly-useful message, and "--clean" will remove any saved
balloon data. For more advanced use, you can enter a Contest API URL, user, and
password to connect directly to a Contest API server upon startup.


=== Input Data Sources

When the BU starts it displays a screen similar to the following:

image::BUStartupScreen.png[Balloon Utility Startup Screen,align="center"]

(If existing data was loaded it will be displayed in the screen; otherwise the
screen will be unpopulated as shown above.)

In order to use the BU once it is started, it must 
be connected to the _event feed_ output of a 
_Contest Control System (CCS)_.
The Balloon Utility will work with any event feed which is 
compliant with the _CLI CCS Specification_ defined at 
https://clics.ecs.baylor.edu/.  
CCS's known to produce compliant event feeds include 
http://pc2.ecs.csus.edu/pc2[PC-Squared] and 
https://www.kattis.com/[Kattis]; 
other Contest Control Systems may also produce compatible event feeds and 
hence work with the Balloon Utility.

The BU is capable of operating with contest data obtained from one of three
different sources: a Contest API source (e.g. CCS or CDS), an _event feed file_, or
a _socket connection_ directly to an active CCS.

Pressing the "Connect" button (above) will produce the following dialog, used to 
select the event feed input source for the BU.

image::BUSourceSelectionDialog.png[BUSourceSelection,align=center]

The BU can be connected
to an event feed file using the bottom selection in the Connect dialog.
An event feed file is created off-line (that is, by steps external to 
the Balloon Utility) by connecting to port 4713 on a machine
running a compatible CCS and saving the resulting output to a file (see 
https://clics.ecs.baylor.edu/index.php/Event_Feed for details on the structure of an event feed).  

Connecting the BU directly to a running (compatible) CCS is done by entering 
the Host IP address and port number in the middle entry of the Connect dialog.
Note that the default event feed port for ICPC-compatible CCS's is 4713. 

Alternatively, the BU can obtain its event feed data from a Contest Data Server (CDS). 
A CDS provides URL access points for obtaining event feed and other contest data; 
connecting the BU to a CDS causes it to pull the necessary information dynamically
from the CDS.  
(Note: the CDS must have been configured to connect to a compatible CCS in order
for it to supply event feed data to the BU.)

The main reason for using a CDS instead of a simple event feed file or live 
event feed connection to provide
BU input is that a CDS can also provide other information to the BU.  
For example, if the CDS has been configured with
problem names and balloon colors, the BU knows how to pull these
from the CDS as well and will use them in the output display.  The sample image
presented at the start of this document shows the use of such data; 
these came from connecting the BU to a CDS.


=== Operating the Balloon Utility

Each time a successful-run notification arrives in the event feed the BU will display the
run information in its grid.  If the run represents special conditions, such as being the
first solution for a Team (T), Problem (P), Region or Group +++(R)+++, or in the entire 
Contest +++(C)+++,
corresponding flags are displayed in the "Firsts" column.
The display grid can be sorted on any column by clicking in the corresponding column header.

One of the most common uses of the BU is for printing "Balloon Notification" messages for runners
delivering balloons to teams.
Balloon Notification printouts contain information identifying the team (by name and number),
problem (by letter), the run submission that earned the ballloon (by run ID and submission time)
and the color of the balloon which should be delivered. 

Balloon Notifications may also contain additional information such as how many other balloons 
the team has and any special award categories associated with the new balloon (such as an
indication that it is the team's _first_ balloon or that the balloon represents the first
solution (by any team) of the specified problem.
Balloon Notifications can also be configured to print a map showing where the team is located
on the contest floor, although the mechanism for configuring this map is not documented at this time.

A sample Balloon Notification is shown below: 

image::PrintPreview.png["Balloon utility print preview",align="center"]

To select the printer to be used for printing Balloon Notifications,
pull down the "Print" menu in the upper left corner of the main screen and
select "Configure Printer"; this will display a list of
all printers known to the underlying system and any of these can be selected for use by the BU.

The selected printer can be changed
at any time (again, using the Print menu), and the same menu also allows for sending a 
"Test Message" to the printer to be sure it is working.

The _Automatically print new balloons_ checkbox at the bottom of the main screen can be used to
enable or disable automatic printing; if enabled, then whenever a new successful-run notification
is received in the event feed the BU will automatically print a new Balloon Notification message
to the currently-configured printer.  

Selecting one or more rows in the grid (by clicking on them) and then pressing _Print Preview_
will print an on-screen version of the Balloon Notification(s) for the selected row(s).
Selecting one or more rows and pressing _Print_ will send Balloon Notification(s) for the
selected rows to the currently configured printer (even if the notifications have previously been printed).
Whenever a notification has been printed (including as a result of "automatic printing"),
the BU places a "Y" indication in the "Printed" column.

The _Print Summary_ buttons allow you to print a complete list of balloons for verification, either
a list for rows currently selected in the grid or a complete summary of all balloon notifications
for the contest up to the moment.  This can be used for example to verify that the balloons which
should have been sent to a given team are actually present on the contest floor 
(by sorting on the Team column and then selecting all runs for that team followed by pressing  
_Print Selected Summary_), or to check that all of the balloons on the contest floor match what
they should be.

The "Delivered" column is used to track when balloons have actually been delivered to teams.
Each time a runner delivers a balloon, they should select the corresponding row in the grid
and click the _Toggle Delivery_ button.  This will insert a "Y" in the "Delivered" column,
providing an easy way to keep track of delivered notifications.  The "Y" notification can
be removed if desired by selecting the row and clicking "Toggle Delivery" again.
Note also that Balloon Notification printouts have a "Delivered By" signature space near the
bottom to allow balloon runners to record that they delivered the corresponding balloon.

The _Filter by group_ label (just above the main screen grid, on the left side) can be used to restrict the
balloons which are processed by the BU.  Clicking on the text next to the label (it shows as 
"All..." in the following screenshot) produces a drop-down list of the
currently-defined "groups" (also called "regions") defined in the contest, similar to the following:

image::GroupDropdown.png["Balloon utility group list",align="center"]

Disabling one or more groups (by unchecking the corresponding checkbox) suppresses the Balloon Utility's 
processing of Balloon Notifications for the disabled group(s).  This allows the balloon handling crew
at contests taking place simultaneously at multiple sites to avoid having to deal with Balloon Notifications
for teams which are not at their site.

Note that the definition of the groups in a contest comes from data in the event feed read by the BU; 
groups cannot be directly defined within the Balloon Utility itself.


